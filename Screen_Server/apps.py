import logging
import threading

from django.apps import AppConfig


class ScreenServerConfig(AppConfig):
    """
    –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Django –¥–ª—è –º–æ–¥—É–ª—è `Screen_Server`.

    –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ñ–æ–Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫, –∫–æ—Ç–æ—Ä—ã–π
    –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–µ—Ç–µ–≤–æ–π —Å–Ω–∏—Ñ—Ñ–µ—Ä (–Ω–∞ –±–∞–∑–µ Scapy) –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è UDP-–ø–∞–∫–µ—Ç–æ–≤.
    –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–µ—Ä–≤–µ—Ä—É –ø—Ä–∏–Ω–∏–º–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
    """
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'Screen_Server'

    def ready(self):
        """
        –ú–µ—Ç–æ–¥, –≤—ã–∑—ã–≤–∞–µ–º—ã–π Django –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
        –ó–¥–µ—Å—å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ñ–æ–Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ —Å `start_sniffing_thread`, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—á–∏–Ω–∞–µ—Ç
        –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ UDP-–ø–æ—Ä—Ç–æ–≤. –ü–æ—Ç–æ–∫ –æ—Ç–º–µ—á–µ–Ω –∫–∞–∫ daemon, —á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞.
        """
        from .views import start_sniffing_thread
        logging.info("üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–æ–Ω–æ–≤—ã–π —Å–Ω–∏—Ñ—Ñ–µ—Ä –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞...")
        sniff_thread = threading.Thread(target=start_sniffing_thread, daemon=True)
        sniff_thread.start()
